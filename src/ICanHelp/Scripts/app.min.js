var Shared;!function(a){!function(a){function b(a){return{restrict:"A",require:"ngModel",link:function(b,c,d,e){e.$parsers.push(function(b){return e.$setValidity("uniqueEmail",!0),e.$valid&&(e.$setValidity("checkingEmail",!1),""!==b&&"undefined"!=typeof b?a.get("/api/account/emailUnique/"+b).success(function(){e.$setValidity("uniqueEmail",!0),e.$setValidity("checkingEmail",!0)}).error(function(){e.$setValidity("uniqueEmail",!1),e.$setValidity("checkingEmail",!0)}):(e.$setValidity("uniqueEmail",!1),e.$setValidity("checkingEmail",!0))),b})}}}a.UniqueEmail=b}(a.Validators||(a.Validators={}));a.Validators}(Shared||(Shared={}));var Shared;!function(a){!function(a){var b=function(){function a(){this.message=""}return a}();a.ErrorModel=b}(a.Models||(a.Models={}));a.Models}(Shared||(Shared={}));var IndexController=function(){function a(){this.heading="Fajny nagłówek"}return a}(),Account;!function(a){var b=function(){function a(){}return a}();a.LoginRouteParams=b;var c=function(){function a(a,b,c,d){var e=this;this.$location=a,this.$routeParams=b,this.$cookieStore=c,this.service=d,this.email="",this.password="",this.error="",this.submit=function(){e.service.login(e.email,e.password).then(e.loginSuccess,e.loginError)},this.loginSuccess=function(a){var b="_ncfa="+a.authToken+";";document.cookie=b,e.$location.path("/")},this.loginError=function(a){e.error=a.message},this.email=b.email}return a}();a.LoginController=c}(Account||(Account={}));var Account;!function(a){var b=function(){function a(a,b){var c=this;this.$location=a,this.service=b,this.email="",this.password="",this.error="",this.submit=function(){c.service.register(c.email,c.password).then(c.registerSuccess,c.registerError)},this.registerSuccess=function(){c.error="",c.$location.path("/account/login/"+c.email)},this.registerError=function(a){c.error=a}}return a}();a.RegisterController=b}(Account||(Account={}));var Account;!function(a){var b=function(){function a(){}return a}();a.LoginResponse=b;var c=function(){function a(a,b){var c=this;this.$http=a,this.$q=b,this.register=function(a,b){var d=c.$q.defer(),e={email:a,password:b};return c.$http.post("/api/account/register/",e).success(function(){d.resolve()}).error(function(a){d.reject(a)}),d.promise},this.login=function(a,b){var d=c.$q.defer(),e={email:a,password:b};return c.$http.post("/api/account/login/",e).success(function(a){d.resolve(a)}).error(function(a){d.reject(a)}),d.promise}}return a}();a.AccountService=c}(Account||(Account={})),angular.module("icanhelp",["ui.bootstrap","ngRoute","ngCookies"]).config(function(a){return[a.when("/",{templateUrl:"app/home/index/index.html",controller:IndexController,controllerAs:"contr"}),a.when("/account/login/:email?",{templateUrl:"app/account/login/login.html",controller:"loginController",controllerAs:"contr"}),a.when("/account/register",{templateUrl:"app/account/register/register.html",controller:"registerController",controllerAs:"contr"})]}).service("accountService",["$http","$q",Account.AccountService]).controller("registerController",["$location","accountService",Account.RegisterController]).controller("loginController",["$location","$routeParams","$cookieStore","accountService",Account.LoginController]).directive("uniqueEmail",["$http",Shared.Validators.UniqueEmail]);